{"pageProps":{"markdoc":{"content":{"$$mdtype":"Tag","name":"article","attributes":{},"children":[{"$$mdtype":"Tag","name":"Heading","attributes":{"id":"overview","level":1},"children":["アーティファクト"," "]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["アーティファクトは、実際のアプリケーションバイナリやファイルを管理するDewyのコンポーネントです。\nレジストリで特定されたバージョンに対応するファイルをダウンロードし、デプロイメント用に準備します。\n"]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":2,"id":"アーティファクトの種類"},"children":["アーティファクトの種類"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["Dewyは以下のアーティファクトタイプに対応しています。"]},{"$$mdtype":"Tag","name":"ul","attributes":{},"children":[{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"strong","attributes":{},"children":["GitHub Releases"]}," (",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["ghr://"]},"): GitHubリリースの添付ファイル"]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"strong","attributes":{},"children":["AWS S3"]}," (",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["s3://"]},"): S3オブジェクトストレージのファイル"]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"strong","attributes":{},"children":["Google Cloud Storage"]}," (",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["gs://"]},"): GCSオブジェクトストレージのファイル"]}]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["アーティファクトの種類は自動的にレジストリのタイプと連動します。"]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":2,"id":"ファイル形式"},"children":["ファイル形式"]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":3,"id":"対応アーカイブ形式"},"children":["対応アーカイブ形式"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["Dewyは以下のアーカイブ形式をサポートしています。"]},{"$$mdtype":"Tag","name":"ul","attributes":{},"children":[{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"strong","attributes":{},"children":["tar.gz / tgz"]},": 最も一般的な形式"]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"strong","attributes":{},"children":["tar"]},": 非圧縮tar"]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"strong","attributes":{},"children":["zip"]},": Windows環境でよく使用される形式"]}]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":3,"id":"アーカイブ構造"},"children":["アーカイブ構造"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["アーティファクトは以下のような構造で作成することを推奨します："]},{"$$mdtype":"Tag","name":"Fence","attributes":{},"children":["myapp_linux_amd64.tar.gz\n├── myapp                 # 実行可能バイナリ\n├── config/\n│   └── app.conf         # 設定ファイル\n├── static/\n│   ├── css/\n│   └── js/\n└── README.md\n"]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":2,"id":"ファイル命名規則"},"children":["ファイル命名規則"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["アーティファクト名を明示的に指定しない場合、Dewyは以下のパターンでファイルを自動選択します："]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"bash"},"children":["# 推奨パターン\n<app-name>_<os>_<arch>.<ext>\n\n# 例\nmyapp_linux_amd64.tar.gz\nmyapp_darwin_arm64.tar.gz\nmyapp_windows_amd64.zip\n"]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":3,"id":"os識別子"},"children":["OS識別子"]},{"$$mdtype":"Tag","name":"Table","attributes":{},"children":[{"$$mdtype":"Tag","name":"thead","attributes":{},"children":[{"$$mdtype":"Tag","name":"tr","attributes":{},"children":[{"$$mdtype":"Tag","name":"th","attributes":{},"children":["OS"]},{"$$mdtype":"Tag","name":"th","attributes":{},"children":["識別子"]},{"$$mdtype":"Tag","name":"th","attributes":{},"children":["例"]}]}]},{"$$mdtype":"Tag","name":"tbody","attributes":{},"children":[{"$$mdtype":"Tag","name":"tr","attributes":{},"children":[{"$$mdtype":"Tag","name":"td","attributes":{},"children":["Linux"]},{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"code","attributes":{},"children":["linux"]}]},{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"code","attributes":{},"children":["myapp_linux_amd64.tar.gz"]}]}]},{"$$mdtype":"Tag","name":"tr","attributes":{},"children":[{"$$mdtype":"Tag","name":"td","attributes":{},"children":["macOS"]},{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"code","attributes":{},"children":["darwin"]},", ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["macos"]}]},{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"code","attributes":{},"children":["myapp_darwin_arm64.tar.gz"]}]}]},{"$$mdtype":"Tag","name":"tr","attributes":{},"children":[{"$$mdtype":"Tag","name":"td","attributes":{},"children":["Windows"]},{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"code","attributes":{},"children":["windows"]},", ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["win"]}]},{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"code","attributes":{},"children":["myapp_windows_amd64.zip"]}]}]}]}]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":3,"id":"アーキテクチャ識別子"},"children":["アーキテクチャ識別子"]},{"$$mdtype":"Tag","name":"Table","attributes":{},"children":[{"$$mdtype":"Tag","name":"thead","attributes":{},"children":[{"$$mdtype":"Tag","name":"tr","attributes":{},"children":[{"$$mdtype":"Tag","name":"th","attributes":{},"children":["アーキテクチャ"]},{"$$mdtype":"Tag","name":"th","attributes":{},"children":["識別子"]},{"$$mdtype":"Tag","name":"th","attributes":{},"children":["例"]}]}]},{"$$mdtype":"Tag","name":"tbody","attributes":{},"children":[{"$$mdtype":"Tag","name":"tr","attributes":{},"children":[{"$$mdtype":"Tag","name":"td","attributes":{},"children":["x86_64"]},{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"code","attributes":{},"children":["amd64"]},", ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["x86_64"]}]},{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"code","attributes":{},"children":["myapp_linux_amd64.tar.gz"]}]}]},{"$$mdtype":"Tag","name":"tr","attributes":{},"children":[{"$$mdtype":"Tag","name":"td","attributes":{},"children":["ARM64"]},{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"code","attributes":{},"children":["arm64"]},", ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["aarch64"]}]},{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"code","attributes":{},"children":["myapp_darwin_arm64.tar.gz"]}]}]},{"$$mdtype":"Tag","name":"tr","attributes":{},"children":[{"$$mdtype":"Tag","name":"td","attributes":{},"children":["ARM32"]},{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"code","attributes":{},"children":["arm"]},", ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["armv7"]}]},{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"code","attributes":{},"children":["myapp_linux_arm.tar.gz"]}]}]}]}]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":2,"id":"github-releases-でのアーティファクト"},"children":["GitHub Releases でのアーティファクト"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["基本的な構成"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"bash"},"children":["# レジストリURL\nghr://owner/repo\n\n# 自動選択される例（Linux amd64環境の場合）\nmyapp_linux_amd64.tar.gz\n"]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":3,"id":"リリース作成例"},"children":["リリース作成例"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["GitHub Actionsでのリリース作成とアーティファクト添付："]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"yaml"},"children":["name: Release\non:\n  push:\n    tags: ['v*']\n\njobs:\n  build:\n    strategy:\n      matrix:\n        os: [ubuntu-latest, macos-latest, windows-latest]\n        include:\n          - os: ubuntu-latest\n            goos: linux\n            goarch: amd64\n          - os: macos-latest\n            goos: darwin\n            goarch: arm64\n          - os: windows-latest\n            goos: windows\n            goarch: amd64\n\n    runs-on: ${{ matrix.os }}\n    steps:\n      - uses: actions/checkout@v4\n      \n      - name: Setup Go\n        uses: actions/setup-go@v4\n        with:\n          go-version: '1.21'\n      \n      - name: Build\n        env:\n          GOOS: ${{ matrix.goos }}\n          GOARCH: ${{ matrix.goarch }}\n        run: |\n          go build -o myapp\n          tar -czf myapp_${{ matrix.goos }}_${{ matrix.goarch }}.tar.gz myapp\n      \n      - name: Upload to release\n        uses: actions/upload-release-asset@v1\n        env:\n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n        with:\n          upload_url: ${{ steps.create_release.outputs.upload_url }}\n          asset_path: ./myapp_${{ matrix.goos }}_${{ matrix.goarch }}.tar.gz\n          asset_name: myapp_${{ matrix.goos }}_${{ matrix.goarch }}.tar.gz\n          asset_content_type: application/gzip\n"]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":3,"id":"特定アーティファクトの指定"},"children":["特定アーティファクトの指定"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"bash"},"children":["# 複数のアーティファクトがある場合に特定のものを指定\ndewy server --registry \"ghr://owner/repo?artifact=myapp-server.tar.gz\"\n"]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":2,"id":"aws-s3-でのアーティファクト"},"children":["AWS S3 でのアーティファクト"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["ディレクトリ構造"]},{"$$mdtype":"Tag","name":"Fence","attributes":{},"children":["s3://my-bucket/releases/myapp/\n├── v1.2.3/\n│   ├── myapp_linux_amd64.tar.gz\n│   ├── myapp_linux_arm64.tar.gz\n│   ├── myapp_darwin_arm64.tar.gz\n│   └── myapp_windows_amd64.zip\n├── v1.2.2/\n│   ├── myapp_linux_amd64.tar.gz\n│   └── myapp_darwin_arm64.tar.gz\n└── v1.2.1/\n    └── myapp_linux_amd64.tar.gz\n"]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":3,"id":"アップロード例"},"children":["アップロード例"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"bash"},"children":["# AWS CLIを使用したアップロード\naws s3 cp myapp_linux_amd64.tar.gz \\\n  s3://my-bucket/releases/myapp/v1.2.3/myapp_linux_amd64.tar.gz\n\n# GitHub Actionsでの自動アップロード\n- name: Upload to S3\n  env:\n    AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}\n    AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n  run: |\n    aws s3 cp myapp_linux_amd64.tar.gz \\\n      s3://my-bucket/releases/myapp/${GITHUB_REF_NAME}/\n"]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":2,"id":"google-cloud-storage-でのアーティファクト"},"children":["Google Cloud Storage でのアーティファクト"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["ディレクトリ構造"]},{"$$mdtype":"Tag","name":"Fence","attributes":{},"children":["gs://my-releases/myapp/\n├── v1.2.3/\n│   ├── myapp_linux_amd64.tar.gz\n│   ├── myapp_linux_arm64.tar.gz\n│   └── myapp_darwin_arm64.tar.gz\n└── v1.2.2/\n    └── myapp_linux_amd64.tar.gz\n"]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":3,"id":"アップロード例"},"children":["アップロード例"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"bash"},"children":["# gsutil を使用したアップロード\ngsutil cp myapp_linux_amd64.tar.gz \\\n  gs://my-releases/myapp/v1.2.3/\n\n# GitHub Actionsでの自動アップロード\n- name: Upload to GCS\n  uses: google-github-actions/setup-gcloud@v1\n  with:\n    service_account_key: ${{ secrets.GCP_SA_KEY }}\n    \n- name: Upload artifact\n  run: |\n    gsutil cp myapp_linux_amd64.tar.gz \\\n      gs://my-releases/myapp/${GITHUB_REF_NAME}/\n"]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":2,"id":"アーティファクトの検証"},"children":["アーティファクトの検証"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["アーティファクトの整合性を確保するため、チェックサムファイルを併せて配置することを推奨します。"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"bash"},"children":["# SHA256チェックサムの生成\nsha256sum myapp_linux_amd64.tar.gz > myapp_linux_amd64.tar.gz.sha256\n\n# アップロード（GitHub Releasesの例）\n# - myapp_linux_amd64.tar.gz\n# - myapp_linux_amd64.tar.gz.sha256\n"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["セキュリティを重視する環境では、GPG署名を併せて提供することも可能です。"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"bash"},"children":["# GPG署名の生成\ngpg --detach-sign --armor myapp_linux_amd64.tar.gz\n\n# 結果\n# - myapp_linux_amd64.tar.gz\n# - myapp_linux_amd64.tar.gz.asc\n"]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":2,"id":"トラブルシューティング"},"children":["トラブルシューティング"]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":3,"id":"アーティファクトが見つからない"},"children":["アーティファクトが見つからない"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["命名規則の確認をする。"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"bash"},"children":["# 正しい例\nmyapp_linux_amd64.tar.gz\n\n# 認識されない例\nmyapp-1.2.3.tar.gz\nlinux-binary.tar.gz\n"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["ファイルの存在確認をする。"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"bash"},"children":["# GitHub Releasesでの確認\ncurl -H \"Authorization: token $GITHUB_TOKEN\" \\\n  \"https://api.github.com/repos/owner/repo/releases/latest\"\n"]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":3,"id":"展開エラー"},"children":["展開エラー"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["アーカイブ形式の確認をする。"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"bash"},"children":["# ファイル形式の確認\nfile myapp_linux_amd64.tar.gz\n\n# 手動展開テスト\ntar -tzf myapp_linux_amd64.tar.gz\n"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["権限の確認をする。"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"bash"},"children":["# 実行権限の設定\nchmod +x myapp\n"]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":3,"id":"デバッグ方法"},"children":["デバッグ方法"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"bash"},"children":["# アーティファクトダウンロードのデバッグ\ndewy server --registry ghr://owner/repo --log-level debug\n\n# 特定アーティファクトの指定でテスト\ndewy server --registry \"ghr://owner/repo?artifact=specific-file.tar.gz\"\n"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["アーティファクト管理は Dewy のデプロイメントプロセスにおいて重要な要素です。適切な命名規則と構造化されたファイル配置により、自動デプロイメントを実現できます。"]}]},"frontmatter":{"title":"アーティファクト","description":"アーティファクトは、実際のアプリケーションバイナリやファイルを管理するDewyのコンポーネントです。\nレジストリで特定されたバージョンに対応するファイルをダウンロードし、デプロイメント用に準備します。\n"},"file":{"path":"/ja/artifact.md"}}},"__N_SSG":true}